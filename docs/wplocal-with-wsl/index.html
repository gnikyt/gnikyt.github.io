<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <title>
      WP Local with WSL | gnikyt
    </title>
    <link href="https://gnikyt.com/wplocal-with-wsl" rel="canonical">
    <meta content="Custom" name="generator">
    <meta content=
    "A recent project was picked up from another agency where they utilized WP Engine and WP Local. WP Local *can* work with WSL, but the pro..."
    name="description">
    <meta content="2025-01-15T00:00:00-0330" property="article:published_time">
    <meta content="WP Local with WSL" property="og:title">
    <meta content="en" property="og:locale">
    <meta content=
    "A recent project was picked up from another agency where they utilized WP Engine and WP Local. WP Local *can* work with WSL, but the pro..."
    property="og:description">
    <meta content="https://gnikyt.com/wplocal-with-wsl" property="og:url">
    <meta content="gnikyt" property="og:site_name">
    <meta content="article" property="og:type">
    <meta content="summary" name="twitter:card">
    <meta content=
    "A recent project was picked up from another agency where they utilized WP Engine and WP Local. WP Local *can* work with WSL, but the pro..."
    property="twitter:title">
    <script type="application/ld+json">
    {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "dateModified": "2025-01-15T00:00:00-0330",
    "datePublished": "2025-01-15T00:00:00-0330",
    "description": "
    A recent project was picked up from another agency where they utilized WP Engine and WP Local. WP Local *can* work with WSL, but the pro...",
    "headline": "WP Local with WSL",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://gnikyt.com/wplocal-with-wsl"
    },
    "publisher": {
      "@type": "Organization",
      "logo": {
        "@type": "ImageObject",
        "url": "https://gnikyt.com/assets/favicon-32x32.png"
      }
    },
    "url": "https://gnikyt.com/wplocal-with-wsl"
    }
    </script>
    <link href="/assets/images/favicon.ico" rel="shortcut icon" type="image/x-icon">
    <link href="/assets/images/favicon.png" rel="icon" sizes="32x32" type="image/png">
    <link ref="/feed.xml" rel="self" type="application/atom+xml">
    <link href="/assets/styles/normalize.css" rel="stylesheet">
    <link href="/assets/styles/concrete.css" rel="stylesheet">
    <link href="/assets/styles/style.css" rel="stylesheet">
  </head>
  <body class="layout layout--post" data-handle="wplocal-with-wsl">
    <header class="container">
      <span><a href="/">gnikyt</a></span> <span>Code ramblings.</span>
    </header>

    <main class="container">
      <article>
        <header>
          <h1>
            WP Local with WSL
          </h1>

          <p>
            <time datetime="2025-01-15">Jan 15, 2025</time>
          </p>
        </header>

        <p>
          A recent project was picked up from another agency where they utilized WP Engine and WP Local. WP Local
          <em>can</em> work with WSL, but the provided Debian package file seems to miss some dependencies required to
          properly use it and additionally, some issues cropped up which needed to be solved to have a fully working
          setup.
        </p>

        <h2 id="installation">
          Installation
        </h2>

        <p>
          Download WP Local and save it to your Downloads directory. Next, open your Windows Terminal and run the
          following command:
        </p>

        <p>
          <code>sudo dpkg -i /mnt/c/Users/[your user]/Downloads/local-[version]-linux.deb</code>
        </p>

        <p>
          Replacing <code>[your user]</code> with your Windows username and <code>[version]</code> with the downloaded
          WP Local version, example:
        </p>

        <p>
          <code>sudo dpkg -i /mnt/c/Users/tyler/Downloads/local-8.1.0-linux.deb</code>
        </p>

        <p>
          This will install WP Local and automatically create a Start Menu entry for <code>Local (Ubuntu)</code> (in my
          case), but you can also spawn it through the terminal with <code>/usr/bin/local</code>.
        </p>

        <p>
          <a href="/assets/images/2023/12/wplocal%3Cem%3Erunning.png"><img alt="WP Local Running inside WSL" src=
          "/assets/images/2023/12/wplocal%3C/em%3Erunning.png"></a>
        </p>

        <p>
          Although its open and running, if you immediately tried to connect to WP Engine and pull down a project,
          you'll have displays with errors pop up such as the inability for WP Local to ask for priviliages (sudo) and
          issues for it to properly configure NGINX.
        </p>

        <p>
          With a lot of digging around the web to solve both issues... I came across a great post by <a href=
          "https://community.localwp.com/u/robert77">robert77</a> on the WP Local Community Forums which I will outline
          below.
        </p>

        <h2 id="fixing-dependencies">
          Fixing Dependencies
        </h2>

        <p>
          As mentioned earlier, not all dependencies we actually end up being installed. I am unsure if the Debian
          package defines the dependencies to be installed, or they error upon installing (I did not see an error in my
          case), but... we need more packages regardless!
        </p>

        <p>
          Run <code>sudo apt-get update &amp;& sudo apt-get upgrade</code> to ensure package information is updated and
          accurate.
        </p>

        <p>
          Next, run:
        </p>

        <pre><code>sudo apt-get -y install libaio1 libncurses5 libnss3-tools rsync shared-mime-info desktop-file-utils libxshmfence1 libglu1 libatk1.0-0 libatk-bridge2.0-0 libgtk2.0-0 libgtk-3-0 libgbm-dev libasound2 libnuma-dev libxslt1.1 lxqt-sudo libzip4
</code></pre>
        <p>
          This will ensure were able to display a GUI for the privilaged requests, rync is installed for Local to use,
          and other items.
        </p>

        <p>
          Next we need to download a couple packages manually:
        </p>

        <pre><code>curl -O http://snapshot.debian.org/archive/debian/20190501T215844Z/pool/main/g/glibc/multiarch-support_2.28-10_amd64.deb
sudo dpkg -i multiarch-support_2.28-10_amd64.deb
</code></pre>

        <pre><code>curl -O http://snapshot.debian.org/archive/debian/20141009T042436Z/pool/main/libj/libjpeg8/libjpeg8_8d1-2_amd64.deb
sudo dpkg -i libjpeg8_8d1-2_amd64.deb
sudo cp /usr/lib/x86_64-linux-gnu/libonig.so.5 /usr/lib/x86_64-linux-gnu/libonig.so.4
</code></pre>
        <p>
          This takes care of the needed dependencies.
        </p>

        <h2 id="priviliaged-requests">
          Priviliaged Requests
        </h2>

        <p>
          To enable the ability to ask for privilaged access, we need a way for Local to spawn a GUI to ask for a
          password.
        </p>

        <p>
          Running <code>sudo nano /usr/bin/kdesudo</code> should open a new file. Inside the file, paste the following
          to use LxQT's prompt:
        </p>

        <pre><code>#!/bin/bash
/usr/bin/lxqt-sudo $7
</code></pre>
        <p>
          Then run <code>sudo chmod +x /usr/bin/kdesudo</code> to allow it to be executable.
        </p>

        <p>
          An example of it running:
        </p>

        <p>
          <a href="/assets/images/2023/12/wplocal%3Cem%3Esudo.png"><img alt="LxQT Sudo GUI" src=
          "/assets/images/2023/12/wplocal%3C/em%3Esudo.png"></a>
        </p>

        <h2 id="nginx-fix">
          NGINX Fix
        </h2>

        <p>
          If you are pulling down a project from WP Engine which uses NGINX, it will attempt to set capabilities but be
          unable to. To fix this, run the following:
        </p>

        <pre><code>sudo setcap 'cap_net_bind_service=+ep' /opt/Local/resources/extraResources/lightning-services/nginx-[version]/bin/linux/sbin/nginx`
</code></pre>
        <p>
          Replacing <code>[version]</code> with the current NGINX version listed in the directory, in my case it was
          <code>1.16.0+7</code>.
        </p>

        <h2 id="recommended">
          Recommended
        </h2>

        <p>
          Once completed, recommendation would be to change WP Local to use "localhost" instead of "Site Domains", but
          should you choose to use "Site Domains", you will need to add an entry to your Windows' hosts file
          (<code>C:Windowssystem32driversetchosts</code>) for the domain. For example, if your project was
          <code>jumping-bean.local</code> you would need to add <code>127.0.0.1 jumping-bean.local</code> to the hosts
          file.
        </p>

        <p>
          I chose localhost because it was easier to communicate with a custom frontend that was built for this
          specific project, but it comes down to preference. I also can not speak to how well trusting a self-signed
          certificate works from within WSL to Windows with a browser, I have not tried it.
        </p>

        <h2 id="bonus-git-integration">
          Bonus: Git Integration
        </h2>

        <p>
          If you're curious on how you can pull down a project with WP Local and connect it to either a new or existing
          repository, then it can be achieved by doing the following steps, at a high level:
        </p>

        <ol>
          <li>Pull down the project with WP Local
          </li>

          <li>Open your terminal, change directory into the project
          </li>

          <li>Change directory into <code>app/public</code>
          </li>

          <li>Init a repository
          </li>

          <li>
            <em>(if applicable)</em> Connect to existing repository
          </li>

          <li>
            <em>(if applicable)</em> Pull down repository changes
          </li>
        </ol>

        <p>
          Script:
        </p>

        <pre><code>cs app/public &amp;& \
git init &amp;& \
git remote add origin [url] &amp;& \
git fetch origin master &amp;& \
git reset --hard origin/master
</code></pre>
        <p>
          Replacing <code>[url]</code> with your repository's URL.
        </p>

        <p>
          Once completed, this will allow you to make changes to your code and have it synced with WP Local, and
          additionally deploy the code with WP Local if that is the deployment setup you have in place.
        </p>

        <h2 id="conclusion">
          Conclusion
        </h2>

        <p>
          That's it! A very helpful post from robert77 leads to a working WP Local installation. When previewing the
          site, WSL even opens your default browser (on Windows) just fine.
        </p>

        <footer>
          <div class="sources">
            <a href="/wplocal-with-wsl/index.md">MD</a> | <a href="/wplocal-with-wsl/index.txt">TXT</a> | <a href=
            "https://creativecommons.org/licenses/by/4.0/" rel="noopener" target="_blank">CC-4.0</a>
          </div>
        </footer>
      </article>
    </main>

    <footer class="container">
      <hr>
      <a href="/about"><img alt="Tyler King" src="/assets/images/me.jpg"></a>
      <div>
        <h3>
          Ty King
        </h3>

        <p>
          A self-taught, seasoned, versatile developer from Newfoundland.
        </p>
        <a class="button filled" href="https://github.com/gnikyt" rel="noopener" target="_blank">Github</a> <a class=
        "button" href="/about">About Me</a> <a class="button" href="/assets/files/cv.pdf" target="_blank">CV</a>
        <ul class="colors">
          <li class="color color--a">
          </li>

          <li class="color color--b">
          </li>

          <li class="color color--c">
          </li>

          <li class="color color--d">
          </li>

          <li class="color color--e">
          </li>

          <li class="color color--f">
          </li>
        </ul>
      </div>
    </footer>
  </body>
</html>
