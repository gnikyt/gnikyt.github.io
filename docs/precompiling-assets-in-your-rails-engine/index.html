<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <title>
      Precompiling assets in your Rails Engine | gnikyt
    </title>
    <link href="https://gnikyt.com/precompiling-assets-in-your-rails-engine" rel="canonical">
    <meta content="Custom" name="generator">
    <meta content=
    "This will be a quick post to highlight an issue I had where I needed to precompile an asset file for my Rails engine that was not to be ..."
    name="description">
    <meta content="2016-05-03T23:26:22-0230" property="article:published_time">
    <meta content="Precompiling assets in your Rails Engine" property="og:title">
    <meta content="en" property="og:locale">
    <meta content=
    "This will be a quick post to highlight an issue I had where I needed to precompile an asset file for my Rails engine that was not to be ..."
    property="og:description">
    <meta content="https://gnikyt.com/precompiling-assets-in-your-rails-engine" property="og:url">
    <meta content="gnikyt" property="og:site_name">
    <meta content="article" property="og:type">
    <meta content="summary" name="twitter:card">
    <meta content=
    "This will be a quick post to highlight an issue I had where I needed to precompile an asset file for my Rails engine that was not to be ..."
    property="twitter:title">
    <script type="application/ld+json">
    {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "dateModified": "2016-05-03T23:26:22-0230",
    "datePublished": "2016-05-03T23:26:22-0230",
    "description": "
    This will be a quick post to highlight an issue I had where I needed to precompile an asset file for my Rails engine that was not to be ...",
    "headline": "Precompiling assets in your Rails Engine",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://gnikyt.com/precompiling-assets-in-your-rails-engine"
    },
    "publisher": {
      "@type": "Organization",
      "logo": {
        "@type": "ImageObject",
        "url": "https://gnikyt.com/assets/favicon-32x32.png"
      }
    },
    "url": "https://gnikyt.com/precompiling-assets-in-your-rails-engine"
    }
    </script>
    <link href="/assets/images/favicon.ico" rel="shortcut icon" type="image/x-icon">
    <link href="/assets/images/favicon.png" rel="icon" sizes="32x32" type="image/png">
    <link href="/rss.xml" rel="alternate" title="gnikyt feed" type="application/rss+xml">
    <link href="/assets/styles/normalize.css" rel="stylesheet">
    <link href="/assets/styles/concrete.css" rel="stylesheet">
    <link href="/assets/styles/style.css" rel="stylesheet">
  </head>
  <body class="layout layout--post" data-handle="precompiling-assets-in-your-rails-engine">
    <header class="container">
      <span><a href="/">gnikyt</a></span> <span>Code ramblings.</span>
    </header>

    <main class="container">
      <article>
        <header>
          <h1>
            Precompiling assets in your Rails Engine
          </h1>

          <p>
            <time datetime="2016-05-03">May 03, 2016</time>
          </p>
        </header>

        <p>
          This will be a quick post to highlight an issue I had where I needed to precompile an asset file for my Rails
          engine that was not to be compiled with the other engine assets.
        </p>

        <p>
          Recently, I added <a href="https://github.com/spohlenz/tinymce-rails">TinyMCE-Rails</a> to Guts instead of
          rolling it in on its own. This allows me to abstract TinyMCE so it's handled by the gem, and allows users to
          provide their own customizations and configurations.
        </p>

        <p>
          Previously, I had a custom plugin that was hard-coded into TinyMCE as a simple button to allow users to add
          media from Guts into the editor. Now, using the gem, I need to make this a plugin, but I found issues getting
          the plugin file into production… it would never appear in <code>shared/public</code> when deploying the
          website via Capistrano after precompile ran. I was frustrated at first but knew it had to be a simple answer,
          I just needed to tell Rails about the file.
        </p>

        <p>
          This was the directory structure:
        </p>

        <pre><code>app/
  assets/
    javascripts/
          guts/
              ...
        tinymce/
          plugins/
              guts_media/
                  plugin.js
</code></pre>
        <p>
          I needed my <code>tinymce/plugins/</code> folder to move into <code>public/assets/tinymce</code> generated by
          the TinyMCE gem.
        </p>

        <p>
          After trial and error, the answer was simple and stupid… why didn't I think of it before? I simply need to
          open my engine's file and append my plugin path to <code>assets.precompile</code> provided by Rails. Here was
          the final working result (bottom of the file):
        </p>

        <pre><code># Guts' module namespace
module Guts 
  # Guts' engine class
  class Engine &lt; :⭐:Engine
    # Isolate Guts routes
    isolate_namespace Guts

    # Autoload concerns
    config.autoload_paths &lt;&lt; "#{config.root}/app/concerns"

    # Allow decorator usage for extending Guts
    config.to_prepare do
      Dir.glob("#{Rails.root}/app/decorators/*/guts/*_decorator*.rb").each do |c|
        require_dependency(c)
      end
    end

    # Load in our custom assets to precompile
    config.assets.precompile &lt;&lt; "#{config.root}/app/assets/javascripts/tinymce/plugins/guts_media/plugin.js"
  end
end
</code></pre>
        <p>
          I hope this helps anyone else stuck in a similar situation.
        </p>

        <footer>
          <div class="sources">
            <a href="/precompiling-assets-in-your-rails-engine/index.md">MD</a> | <a href=
            "/precompiling-assets-in-your-rails-engine/index.txt">TXT</a> | <a href=
            "https://creativecommons.org/licenses/by/4.0/" rel="noopener" target="_blank">CC-4.0</a>
          </div>

          <div class="warning post-old">
            This post is 8 years old and may contain outdated information.
          </div>
        </footer>
      </article>
    </main>

    <footer class="container">
      <hr>
      <a href="/about"><img alt="Tyler King" src="/assets/images/me.jpg"></a>
      <div>
        <h3>
          Ty King
        </h3>

        <p>
          A self-taught, seasoned, versatile developer from Newfoundland.
        </p>
        <a class="button filled" href="https://github.com/gnikyt" rel="noopener" target="_blank">Github</a> <a class=
        "button" href="/about">About Me</a> <a class="button" href="/assets/files/cv.pdf" target="_blank">CV</a>
        <ul class="colors">
          <li class="color color--a">
          </li>

          <li class="color color--b">
          </li>

          <li class="color color--c">
          </li>

          <li class="color color--d">
          </li>

          <li class="color color--e">
          </li>

          <li class="color color--f">
          </li>
        </ul>
      </div>
    </footer>
  </body>
</html>
